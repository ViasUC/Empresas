<!-- src/app/oportunidades/components/opportunity-list/opportunity-list.component.html -->

<div class="page-container">
  <!-- Encabezado con botón Volver -->
  <header class="page-header">
    <button class="btn-ghost" (click)="goBack()">
      ← Volver
    </button>

    <div class="page-title-group">
      <h1>Gestión de Oportunidades</h1>
      <p>Administra las ofertas laborales publicadas por tu empresa.</p>
    </div>

    <button class="btn-primary" (click)="nueva()">
      + Nueva Oportunidad
    </button>
  </header>

  <!-- Contenido principal -->
  <section class="card">
    <!-- Filtros -->
    <div class="filters-row">
      <div class="filter-item">
        <label for="filtroTexto">Buscar...</label>
        <input
          id="filtroTexto"
          type="text"
          class="input"
          placeholder="Buscar por título, descripción..."
          [(ngModel)]="filtroTexto"
          (input)="aplicarFiltros()"
        />
      </div>

      <div class="filter-item">
        <label for="filtroEstado">Estado</label>
        <select
          id="filtroEstado"
          class="input"
          [(ngModel)]="filtroEstado"
          (change)="aplicarFiltros()"
        >
          <option value="">Todos los estados</option>
          <option *ngFor="let e of estados" [ngValue]="e.value">
            {{ e.label }}
          </option>
        </select>
      </div>
    </div>

    <!-- Tabla -->
    <div class="table-wrapper">
      <table class="table">
        <thead>
          <tr>
            <th>Título</th>
            <th>Ubicación</th>
            <th>Modalidad</th>
            <th>Tipo</th>
            <th>Estado</th>
            <th class="acciones-col">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="filtered.length === 0">
            <td colspan="6" class="no-results">
              No hay resultados
            </td>
          </tr>

          <tr *ngFor="let opp of filtered">
            <td>{{ opp.titulo }}</td>
            <td>{{ opp.ubicacion }}</td>
            <td>{{ opp.modalidad }}</td>
            <td>{{ opp.tipo }}</td>
            <td>
              <span class="badge" [ngClass]="opp.estado.toLowerCase()">
                {{ opp.estado }}
              </span>
            </td>
            <td class="acciones-col">
              <button class="btn-sm" (click)="editar(opp)">Editar</button>

              <button
                class="btn-sm outline"
                *ngIf="opp.estado === 'BORRADOR'"
                (click)="publish(opp)"
              >
                Publicar
              </button>

              <button
                class="btn-sm outline"
                *ngIf="opp.estado === 'ACTIVA'"
                (click)="pause(opp)"
              >
                Pausar
              </button>

              <button
                class="btn-sm outline"
                *ngIf="opp.estado === 'PAUSADA'"
                (click)="publish(opp)"
              >
                Reanudar
              </button>

              <button
                class="btn-sm outline"
                *ngIf="opp.estado !== 'CERRADA'"
                (click)="close(opp)"
              >
                Cerrar
              </button>

              <button class="btn-sm danger" (click)="delete(opp)">
                Eliminar
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>
</div>
